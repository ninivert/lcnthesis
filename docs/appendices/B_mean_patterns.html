<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Equivalence of neural field dynamics with different embedding dimensionality - Appendix B — Binned sampling of populations and visualization of kernels</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../appendices/A_fixed_points.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appendices/A_fixed_points.html">Appendices</a></li><li class="breadcrumb-item"><a href="../appendices/B_mean_patterns.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Binned sampling of populations and visualization of kernels</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Equivalence of neural field dynamics with different embedding dimensionality</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ninivert/lcnthesis" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../Equivalence-of-neural-field-dynamics-with-different-embedding-dimensionality.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../Equivalence-of-neural-field-dynamics-with-different-embedding-dimensionality.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cover</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/2_neural_fields.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Neural field toy model and simulations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/3_mappings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Mapping neural fields to lower-dimensional embeddings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/4_locality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Locality and numerical convergence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/5_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/A_fixed_points.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Fixed point study in the network of neurons</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/B_mean_patterns.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Binned sampling of populations and visualization of kernels</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#mean-field-derivation" id="toc-mean-field-derivation" class="nav-link active" data-scroll-target="#mean-field-derivation"><span class="header-section-number">B.1</span> Mean field derivation</a></li>
  <li><a href="#sampling-populations-conserves-the-low-rank-structure" id="toc-sampling-populations-conserves-the-low-rank-structure" class="nav-link" data-scroll-target="#sampling-populations-conserves-the-low-rank-structure"><span class="header-section-number">B.2</span> Sampling populations conserves the low-rank structure</a></li>
  <li><a href="#numerical-examples-of-methods-for-estimating-the-01-connectivity-kernel" id="toc-numerical-examples-of-methods-for-estimating-the-01-connectivity-kernel" class="nav-link" data-scroll-target="#numerical-examples-of-methods-for-estimating-the-01-connectivity-kernel"><span class="header-section-number">B.3</span> Numerical examples of methods for estimating the <span class="math inline">\([0,1]\)</span> connectivity kernel</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-mean-patterns" class="quarto-section-identifier">Appendix B — Binned sampling of populations and visualization of kernels</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="mean-field-derivation" class="level2" data-number="B.1">
<h2 data-number="B.1" class="anchored" data-anchor-id="mean-field-derivation"><span class="header-section-number">B.1</span> Mean field derivation</h2>
<p>Let us start by taking <span class="math inline">\(N\)</span> samples of the distribution <span class="math inline">\(\rho(z_1, z_2)\)</span>. As established in <a href="../chapters/2_neural_fields.html#sec-mc"><span>Section&nbsp;2.2.1</span></a>, this defines a network of neurons <span class="math inline">\(i \in \{1,\cdots,N\}\)</span> with connectivity matrix <span class="math inline">\(J_{ij} = w_U(\boldsymbol{v_i}, \boldsymbol{v_j})\)</span>. We recall the evolution equation for the network of neurons:</p>
<p><span id="eq-evolution-network"><span class="math display">\[
\dot h_i(t) = -h_i(t) + \sum_{j=1}^N J_{ij} \phi(h_j(t)).
\tag{B.1}\]</span></span></p>
<p>For now, we do not use the fact that in our setting, <span class="math inline">\(J_{ij}\)</span> is low-rank. Applying the finite-<span class="math inline">\(n\)</span> mapping <span class="math inline">\(S^n\)</span>,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> the neurons <span class="math inline">\(\mathcal{A}= \{i_1, \cdots, i_{|\mathcal{A}|}\}\)</span> will end up in the same 1D bin at position <span class="math inline">\(\alpha\)</span>. We stress that <span class="math inline">\(|\mathcal{A}| \neq 2^n\)</span> in general, because we sample the distribution, instead of applying a grid. There are, however, still <span class="math inline">\(4^n\)</span> 1D bins, each of length <span class="math inline">\(4^{-n}\)</span>.</p>
<p>As explained in the main text, we average the segment together in a bin, and we write the corresponding potential of the segment population at location <span class="math inline">\(\alpha\)</span>:</p>
<p><span id="eq-H"><span class="math display">\[
H_\alpha(t) = \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} h_i(t).
\tag{B.2}\]</span></span></p>
<p>The segment populations interact via the connectivity kernel <span class="math inline">\(\tilde J_{\alpha\beta}\)</span>, and we write the equation of evolution as:</p>
<p><span id="eq-H-evolution"><span class="math display">\[
\dot H_\alpha(t) = -H_\alpha(t) + \sum_{\beta=1}^{4^n} \tilde J_{\alpha\beta} \phi(H_\beta(t)).
\tag{B.3}\]</span></span></p>
<p>Since the neurons in <span class="math inline">\(\mathcal{A}\)</span> receive recurrent currents from neurons in <span class="math inline">\(\mathcal{B}\)</span>, it might seem natural to take <span class="math inline">\(\tilde J_{\alpha\beta}\)</span> to be the average connectivity between the neurons in <span class="math inline">\(\mathcal{A}\)</span> and <span class="math inline">\(\mathcal{B}\)</span>. Furthermore, the neurons in <span class="math inline">\(\mathcal{A}\)</span> receive recurrent currents from all the neurons in <span class="math inline">\(\mathcal{B}\)</span>, which adds a weighing term <span class="math inline">\(|\mathcal{B}|\)</span>:</p>
<p><span id="eq-Jab"><span class="math display">\[
\tilde J_{\alpha\beta} = |\mathcal{B}| \frac{1}{|\mathcal{B}| |\mathcal{A}|} \sum_{i \in \mathcal{A}} \sum_{j \in \mathcal{B}} J_{ij} = \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} \sum_{j \in \mathcal{B}} J_{ij}.
\tag{B.4}\]</span></span></p>
<p>We now verify that our intuition is correct. We substitute the definition of the mean field <a href="#eq-H">Equation&nbsp;<span>B.2</span></a> and the our guess <a href="#eq-Jab">Equation&nbsp;<span>B.4</span></a> into <a href="#eq-H-evolution">Equation&nbsp;<span>B.3</span></a>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} h_i(t) &amp;= \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} h_i(t) + \sum_{\beta=1}^{4^n} \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} \sum_{j \in \mathcal{B}} J_{ij} \phi(H_\beta(t)) \\
\iff&amp;\\
\sum_{i \in \mathcal{A}} h_i(t) &amp;= \sum_{i \in \mathcal{A}} h_i(t) + \sum_{i \in \mathcal{A}} \underbrace{\sum_{\beta=1}^{4^n} \sum_{j \in \mathcal{B}}}_{=\sum_{j=1}^N} J_{ij} \phi(H_\beta(t)) \\
&amp;= \sum_{i \in \mathcal{A}} h_i(t) + \sum_{i \in \mathcal{A}} \sum_{j=1}^N J_{ij} \phi(H_\beta(t)).
\end{aligned}
\]</span></p>
<p>We now make the mean-field approximation by dropping <span class="math inline">\(\sum_{i \in \mathcal{A}}\)</span>, that is, that all the neurons inside of each bin are the same (or at least, sufficiently similar so that the mean-field approximation is not a big mistake, in the sense that there is a lot of variation inside each bin, see <a href="../chapters/4_locality.html"><span>Chapter&nbsp;4</span></a>). Doing so, we recover <a href="#eq-evolution-network">Equation&nbsp;<span>B.1</span></a>, which concludes the proof.</p>
</section>
<section id="sampling-populations-conserves-the-low-rank-structure" class="level2" data-number="B.2">
<h2 data-number="B.2" class="anchored" data-anchor-id="sampling-populations-conserves-the-low-rank-structure"><span class="header-section-number">B.2</span> Sampling populations conserves the low-rank structure</h2>
<p>In <a href="#eq-Jab">Equation&nbsp;<span>B.4</span></a>, we defined the connectivity of the binned segment populations as the average connectivity of the corresponding neurons sampled in the 2D embedding. In the case of low-rank <span class="math inline">\(J_{ij}\)</span>, we can show the resulting <span class="math inline">\(\tilde J_{\alpha\beta}\)</span> also has a low-rank structure.</p>
<p><span class="math display">\[
\begin{aligned}
\tilde J_{\alpha\beta} &amp;= \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} \sum_{j \in \mathcal{B}} J_{ij} \\
&amp;= \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} \sum_{j \in \mathcal{B}} \frac 1N \sum_{\mu=1}^p F_{\mu i} G_{\mu j} \\
&amp;= \frac{1}{|\mathcal{A}| N} \sum_{\mu=1}^p \left(\sum_{i \in \mathcal{A}} F_{\mu i} \right) \left(\sum_{j \in \mathcal{B}} G_{\mu j} \right)
\end{aligned}
\]</span></p>
<p>The form of the connectivity motivates the definition of <em>mean low-rank vectors</em>:</p>
<p><span id="eq-mean-lr-vectors"><span class="math display">\[
\tilde F_{\mu\alpha} = \frac{1}{|\mathcal{A}|} \sum_{i \in \mathcal{A}} F_{\mu i},\quad \tilde G_{\mu\beta} = \frac{1}{|\mathcal{B}|} \sum_{j \in \mathcal{B}} G_{\mu j}.
\tag{B.5}\]</span></span></p>
<p>Additionally, we note that <span class="math inline">\(N = \sum_{\beta^\prime} |\mathcal{B}^\prime|\)</span>, and substituting, we find that:</p>
<p><span id="eq-Jab-mean-lr"><span class="math display">\[
\tilde J_{\alpha\beta} = \frac{|\mathcal{B}|}{\sum_{\beta^\prime} |\mathcal{B}^\prime|} \sum_{\mu=1}^p \tilde F_{\mu\alpha} \tilde G_{\mu\beta},
\tag{B.6}\]</span></span></p>
<p>which shows that <span class="math inline">\(\tilde J_{\alpha\beta}\)</span> has a low-rank structure.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><a href="#eq-Jab-mean-lr">Equation&nbsp;<span>B.6</span></a> also nicely complements the intuition that the more neurons there are in each bin, the more “important” this bin should be. This is expressed through the weights <span class="math inline">\(\frac{|\mathcal{B}|}{\sum_{\beta^\prime} |\mathcal{B}^\prime|}\)</span>.</p>
<!-- The weighting also shows up if we express the overlap with respect to the mean-field $H_\alpha(t)$:
$$
\tilde m_\mu(t) = \frac{1}{\sum_{\alpha} |\A|} \sum_\alpha |\A| G_{\mu,\alpha} \phi(H_\alpha(t))
$$ -->
<p>We have hereby shown that sampling neurons in the 2D embeddings, and binning the correponding mappings (downsampling), yields the concept of “mean patterns” from <a href="#eq-mean-lr-vectors">Equation&nbsp;<span>B.5</span></a>.</p>
</section>
<section id="numerical-examples-of-methods-for-estimating-the-01-connectivity-kernel" class="level2" data-number="B.3">
<h2 data-number="B.3" class="anchored" data-anchor-id="numerical-examples-of-methods-for-estimating-the-01-connectivity-kernel"><span class="header-section-number">B.3</span> Numerical examples of methods for estimating the <span class="math inline">\([0,1]\)</span> connectivity kernel</h2>
<p>For the sake of illustration, let us compare the connectivity kernels obtained using different methods in <a href="#fig-kernels">Figure&nbsp;<span>B.1</span></a>. These three approximations are equivalent, since they yield the same dynamics in the <span class="math inline">\(N \to \infty\)</span> limit.</p>
<ul>
<li><a href="#fig-kernels-1">Figure&nbsp;<span>B.1 (a)</span></a> is the method described in this appendix, based on sampling <span class="math inline">\(N\)</span> neurons in the PDF space <span class="math inline">\(\mathbb R^2\)</span>, applying the mapping on the obtained positions <span class="math inline">\(\boldsymbol{z_i}\)</span>, and finally applying the binning (this is coarse-graining). We see, through the empty rows in the connectivity, that due to finite-<span class="math inline">\(N\)</span> effects, locations where <span class="math inline">\(\rho\)</span> is small are not represented, and, as a consequence, no neurons are present in the corresponding 1D bin. When this happens, we set these rows to zero.</li>
<li>To obtain <a href="#fig-kernels-2">Figure&nbsp;<span>B.1 (b)</span></a>, we make the approximation that the support of <span class="math inline">\(\rho(z_1, z_2)\)</span> is compact in <span class="math inline">\([-4,4]\times[-4,4]\)</span>, which of course is not true, but in the case of a Gaussian distribution this is a reasonable approximation, because <span class="math inline">\(\mathrm{CDF}(4) \approx 0.999968\)</span>. Defining <span class="math inline">\(\tilde \rho = \rho \circ S^{-1}\)</span>, the grid is numerically renormalized so that despite the compact support approximation, the probabilities sum up to one, and the connectivity matrix is modified so that the columns are weighed by <span class="math inline">\(\tilde \rho(\beta)\)</span>: <span class="math display">\[
\tilde J_{\alpha\beta} = \tilde \rho(\beta) \sum_{\mu=1}^p \tilde F_{\mu \alpha} \tilde G_{\mu \beta}
\]</span> We see that compared to <a href="#fig-kernels-1">Figure&nbsp;<span>B.1 (a)</span></a>, using the grid method allows us to “sample” the locations where the density is small, and this results in less “whited-out” <em>rows</em>. Still, vertical bands of very fade colour correspond to the reweighing of the <em>columns</em> where <span class="math inline">\(\tilde \rho(\beta)\)</span> is small.</li>
<li>Finally, <a href="#fig-kernels-3">Figure&nbsp;<span>B.1 (c)</span></a> shows the kernel obtained from applying the grid method in the CDF space <span class="math inline">\([0,1]^2\)</span>, as described in <a href="../chapters/2_neural_fields.html#sec-mapping-cdf"><span>Section&nbsp;2.5</span></a>. We see that the connectivity seems much more “uniform”, because each point of the grid has “equal weight” in the CDF space.</li>
</ul>
<div id="fig-kernels" class="cell quarto-layout-panel" data-execution_count="3">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-kernels-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="B_mean_patterns_files/figure-html/fig-kernels-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-kernels"></p>
<figcaption class="figure-caption">(a) Sampling neurons <span class="math inline">\(\boldsymbol{z_i} \sim \rho(z_1, z_2)\)</span> and binning the corresponding mappings.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-kernels-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="B_mean_patterns_files/figure-html/fig-kernels-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-kernels"></p>
<figcaption class="figure-caption">(b) Grid method in a subset of the PDF space <span class="math inline">\([-4,4]\times[-4,4] \subset \mathbb R^2\)</span>.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-kernels-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="B_mean_patterns_files/figure-html/fig-kernels-output-3.svg" class="img-fluid figure-img" data-ref-parent="fig-kernels"></p>
<figcaption class="figure-caption">(c) Grid method in the CDF space <span class="math inline">\([0,1]^2\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;B.1: Comparison of methods for computing the connectivity matrices <span class="math inline">\(\tilde J_{\alpha\beta}\)</span> approximating the kernel <span class="math inline">\(\tilde w(\alpha,\beta)\)</span>.</figcaption><p></p>
</figure>
</div>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-schmutz2023convergence" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">V. Schmutz, J. Brea, and W. Gerstner, <span>“Convergence of redundancy-free spiking neural networks to rate networks,”</span> 2023 [Online]. Available: <a href="https://arxiv.org/abs/2303.05174">https://arxiv.org/abs/2303.05174</a></div>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We are glossing over the fact that <span class="math inline">\(S^n : [0,1]^2 \mapsto [0,1]\)</span>, but the positions <span class="math inline">\(\boldsymbol{z_i} \in \mathbb R^2\)</span>. In the code, we can deal with these by either applying the inverse CDF (as described in <a href="../chapters/2_neural_fields.html#sec-mapping-cdf"><span>Section&nbsp;2.5</span></a>), or considering a bounding box <span class="math inline">\([\min_i(z_{1,i}), \max_i(z_{1,i})] \times [\min_i(z_{2,i}), \max_i(z_{2,i})]\)</span> of the sampled points, which is then rescaled to <span class="math inline">\([0,1] \times [0,1]\)</span> (see implementation for <a href="https://github.com/ninivert/lcnthesis/blob/master/notebooks/neurodyn/_mapping.py#L24"><code>Box</code></a>). Both approaches are equivalent, in the sense that they give rise to the same dynamics as <span class="math inline">\(n\)</span> becomes large, although the obtained connectivity matrix <span class="math inline">\(\tilde J_{\alpha\beta}\)</span> may not be the identical.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We note that if we exclude self-connections (as is done in <span class="citation" data-cites="schmutz2023convergence"><a href="../references.html#ref-schmutz2023convergence" role="doc-biblioref">[1]</a></span>), that is we redefine <span class="math inline">\(J_{ij} \mapsto (1 - \mathrm{Id}_{ij}) J_{ij}\)</span>, then we can show that <span class="math inline">\(\tilde J_{\alpha\beta}\)</span> becomes <span class="math display">\[
  \tilde J_{\alpha\beta} = \frac{|\mathcal{B}|}{\sum_{\beta^\prime} |\mathcal{B}^\prime|} \sum_{\mu=1}^p \tilde F_{\mu\alpha} \tilde G_{\mu\beta} - \mathrm{Id}_{\alpha\beta} \frac{|\mathcal{B}|}{\sum_{\beta^\prime} |\mathcal{B}^\prime|} \sum_{\mu=1}^p \sum_{i \in \mathcal{A}} \frac{F_{\mu i}}{|\mathcal{A}|} \frac{G_{\mu i}}{|\mathcal{A}|}.
  \]</span> We see that the correction is still of order <span class="math inline">\(\mathcal{O}(\tfrac{1}{N})\)</span>, and therefore can be again ignored in the <span class="math inline">\(N \to \infty\)</span> limit.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../appendices/A_fixed_points.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Fixed point study in the network of neurons</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>